<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Freebe Helper ‚Äî Enzo Gazzoli</title>
  <style>
    :root {
      --bg: #111;
      --panel: #1e1e1e;
      --border: #333;
      --text: #e5e5e5;
      --text-dim: #a3a3a3;
      --accent: #3b82f6; /* Blue */
      --accent-hover: #2563eb;
      --success: #22c55e;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }

    body {
      background: var(--bg);
      color: var(--text);
      height: 100vh;
      overflow: hidden;
      display: flex;
    }

    /* LEFT PANEL - CONFIG */
    .config-panel {
      width: 450px;
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      background: var(--panel);
      overflow-y: auto;
    }

    .header {
      padding: 24px;
      border-bottom: 1px solid var(--border);
    }

    .header h1 { font-size: 1.2rem; font-weight: 700; color: white; }
    .header p { font-size: 0.85rem; color: var(--text-dim); margin-top: 4px; }

    .scroll-content {
      padding: 24px;
      flex: 1;
    }

    .section-label {
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--text-dim);
      margin-bottom: 12px;
      letter-spacing: 0.05em;
    }

    .project-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 24px;
    }

    .project-card {
      background: #2a2a2a;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }

    .project-card:hover { border-color: var(--text-dim); }
    
    .project-card.active {
      background: rgba(59, 130, 246, 0.1);
      border-color: var(--accent);
      color: var(--accent);
    }

    .project-icon { font-size: 1.5rem; margin-bottom: 8px; display: block; }
    .project-name { font-size: 0.9rem; font-weight: 600; }

    .subtype-select {
      width: 100%;
      background: #2a2a2a;
      border: 1px solid var(--border);
      color: white;
      padding: 12px;
      border-radius: 8px;
      font-size: 0.95rem;
      margin-bottom: 24px;
      cursor: pointer;
      outline: none;
    }

    .subtype-select:focus { border-color: var(--accent); }

    .options-list {
      margin-bottom: 24px;
    }

    .option-category {
      margin-bottom: 20px;
    }

    .category-header {
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--text-dim);
      margin-bottom: 8px;
      padding: 6px 10px;
      background: rgba(255,255,255,0.03);
      border-radius: 4px;
    }

    .option-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 4px;
      flex-wrap: wrap;
      gap: 8px;
    }

    .option-item:hover { background: #2a2a2a; }

    .option-item input {
      margin-right: 8px;
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }

    .option-name {
      flex: 1;
      min-width: 120px;
    }

    .option-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.7rem;
      color: var(--text-dim);
    }

    .option-price {
      color: var(--accent);
      font-weight: 600;
      font-size: 0.75rem;
    }

    .option-effort {
      background: #333;
      padding: 2px 6px;
      border-radius: 3px;
    }

    .complexity-dots {
      display: flex;
      gap: 2px;
    }

    .complexity-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #444;
    }

    .complexity-dot.active { background: var(--accent); }
    .complexity-dot.active.easy { background: #22c55e; }
    .complexity-dot.active.medium { background: #f59e0b; }
    .complexity-dot.active.complex { background: #ef4444; }

    .option-item.included {
      opacity: 0.7;
      pointer-events: none;
    }

    .option-item.included input { accent-color: var(--success); }
    .option-item.included .option-name::after {
      content: " (Inclus)";
      color: var(--success);
      font-size: 0.7rem;
      font-weight: 600;
    }

    .option-item.warning {
      border: 1px solid #f59e0b;
      background: rgba(245, 158, 11, 0.1);
    }

    .option-warning {
      width: 100%;
      font-size: 0.7rem;
      color: #f59e0b;
      padding: 4px 0 0 28px;
    }

    .dependency-warning {
      background: rgba(245, 158, 11, 0.1);
      border: 1px solid #f59e0b;
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 16px;
      font-size: 0.85rem;
      color: #f59e0b;
    }

    .dependency-warning strong { color: white; }

    /* RIGHT PANEL - OUTPUT */
    .output-panel {
      flex: 1;
      padding: 40px;
      overflow-y: auto;
      background: #111;
    }

    .output-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }

    .card-title {
      font-size: 1rem;
      font-weight: 600;
      color: white;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge {
      background: #333;
      color: var(--text-dim);
      font-size: 0.7rem;
      padding: 2px 6px;
      border-radius: 4px;
      text-transform: uppercase;
    }

    .field-group {
      margin-bottom: 16px;
    }

    .field-label {
      font-size: 0.75rem;
      color: var(--text-dim);
      margin-bottom: 6px;
      display: flex;
      justify-content: space-between;
    }

    .field-value {
      background: #000;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 12px;
      font-family: "Menlo", monospace;
      font-size: 0.9rem;
      color: #e5e5e5;
      position: relative;
      cursor: pointer;
      transition: border-color 0.2s;
    }

    .field-value:hover { border-color: var(--text-dim); }
    
    .field-value textarea {
      width: 100%;
      background: transparent;
      border: none;
      color: inherit;
      font-family: inherit;
      font-size: inherit;
      resize: none;
      outline: none;
      min-height: 150px;
      line-height: 1.5;
    }

    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: var(--accent);
      color: white;
      border: none;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .field-value:hover .copy-btn { opacity: 1; }

    .copy-btn.copied { background: var(--success); }

    .price-tag {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--success);
    }

  </style>
</head>
<body>

  <!-- CONFIG PANEL -->
  <div class="config-panel">
    <div class="header">
      <h1>Freebe Helper</h1>
      <p>Configure ton devis, copie, colle.</p>
    </div>

    <div class="scroll-content">
      
      <!-- 1. PROJET -->
      <div class="section-label">1. Type de Projet</div>
      <div class="project-grid">
        <div class="project-card active" onclick="selectProject('website')">
          <span class="project-icon">üåê</span>
          <div class="project-name">Site Web</div>
        </div>
        <div class="project-card" onclick="selectProject('application')">
          <span class="project-icon">‚ö°Ô∏è</span>
          <div class="project-name">App / SaaS</div>
        </div>
        <div class="project-card" onclick="selectProject('shopify')">
          <span class="project-icon">üõç</span>
          <div class="project-name">Shopify</div>
        </div>
        <div class="project-card" onclick="selectProject('custom')">
          <span class="project-icon">üõ†</span>
          <div class="project-name">Consulting</div>
        </div>
      </div>

      <!-- 2. SOUS-TYPE -->
      <div class="section-label">2. Pr√©cision</div>
      <select id="subTypeSelect" class="subtype-select" onchange="changeSubtype()">
        <!-- JS filled -->
      </select>

      <!-- 3. OPTIONS -->
      <div class="section-label">3. Options & Features</div>
      <div id="optionsList" class="options-list">
        <!-- JS filled -->
      </div>

      <!-- 4. PARAM√àTRES -->
      <div class="section-label">4. Param√®tres</div>
      <div class="option-item">
        <label style="flex:1; font-size: 0.9rem;">Acompte √† la commande</label>
        <select id="acompteSelect" onchange="updateUI()" style="background:#2a2a2a; border:1px solid #333; color:white; padding:4px; border-radius:4px;">
          <option value="0">0%</option>
          <option value="30" selected>30%</option>
          <option value="50">50%</option>
          <option value="100">100%</option>
        </select>
      </div>

    </div>
  </div>

  <!-- OUTPUT PANEL -->
  <div class="output-panel">
    <div class="output-container">

      <!-- SECTION FREEBE -->
      <div style="background: rgba(59, 130, 246, 0.1); border: 1px solid var(--accent); border-radius: 8px; padding: 16px; margin-bottom: 24px;">
        <div style="font-size: 1rem; font-weight: 700; color: var(--accent); margin-bottom: 8px;">üìã POUR FREEBE</div>
        <div style="font-size: 0.8rem; color: var(--text-dim);">Copier ces champs dans Freebe. Description courte et pro.</div>
      </div>

      <!-- BLOC 1 : ARTICLE PRINCIPAL -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">üì¶ Article Principal <span class="badge">Freebe</span></div>
          <div class="price-tag" id="displayPrice">0 ‚Ç¨</div>
        </div>

        <div class="field-group">
          <div class="field-label">D√âSIGNATION</div>
          <div class="field-value" onclick="copyText('out-designation', this)">
            <span id="out-designation">...</span>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>

        <div class="field-group">
          <div class="field-label">PRIX UNITAIRE HT</div>
          <div class="field-value" onclick="copyText('out-price', this)">
            <span id="out-price">0</span>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>

        <div class="field-group">
          <div class="field-label">DESCRIPTION (courte, pour le devis PDF)</div>
          <div class="field-value" onclick="copyText('out-desc', this)">
            <textarea id="out-desc" readonly></textarea>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>
      </div>

      <!-- BLOC 2 : MENTIONS FREEBE -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">üìù Mentions L√©gales <span class="badge">Freebe</span></div>
        </div>

        <div class="field-group">
          <div class="field-label">NOTES / CGV (pour Freebe)</div>
          <div class="field-value" onclick="copyText('out-notes', this)">
            <textarea id="out-notes" readonly style="min-height: 150px;"></textarea>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>
      </div>

      <!-- SEPARATOR -->
      <div style="border-top: 2px dashed var(--border); margin: 32px 0; position: relative;">
        <span style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: #111; padding: 0 16px; color: var(--text-dim); font-size: 0.75rem;">ANNEXE TECHNIQUE (√† envoyer s√©par√©ment)</span>
      </div>

      <!-- SECTION ANNEXE -->
      <div style="background: rgba(34, 197, 94, 0.1); border: 1px solid var(--success); border-radius: 8px; padding: 16px; margin-bottom: 24px; display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-size: 1rem; font-weight: 700; color: var(--success); margin-bottom: 4px;">üìÑ ANNEXE TECHNIQUE</div>
          <div style="font-size: 0.8rem; color: var(--text-dim);">D√©tails complets √† envoyer en pi√®ce jointe.</div>
        </div>
        <button onclick="generateAnnexePDF()" style="background: var(--success); color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.85rem; display: flex; align-items: center; gap: 8px;">
          üì• G√©n√©rer PDF
        </button>
      </div>

      <!-- BLOC 3 : PLANNING & PHASES -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">üìÖ Planning & Phases <span class="badge">Timeline</span></div>
          <div id="displayDuration" style="font-size: 0.9rem; color: var(--accent); font-weight: 600;">‚Äî</div>
        </div>

        <div class="field-group">
          <div class="field-label">PHASES DU PROJET</div>
          <div class="field-value" onclick="copyText('out-phases', this)">
            <textarea id="out-phases" readonly style="min-height: 180px;"></textarea>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>
      </div>

      <!-- BLOC 3 : LIVRABLES -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">üì¶ Livrables <span class="badge">Outputs</span></div>
        </div>

        <div class="field-group">
          <div class="field-label">CE QUE VOUS RECEVEZ</div>
          <div class="field-value" onclick="copyText('out-deliverables', this)">
            <textarea id="out-deliverables" readonly style="min-height: 120px;"></textarea>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>
      </div>

      <!-- BLOC 4 : PR√âREQUIS -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">üìã Pr√©requis Client <span class="badge">√Ä fournir</span></div>
        </div>

        <div class="field-group">
          <div class="field-label">√âL√âMENTS N√âCESSAIRES AU D√âMARRAGE</div>
          <div class="field-value" onclick="copyText('out-prerequisites', this)">
            <textarea id="out-prerequisites" readonly style="min-height: 120px;"></textarea>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>
      </div>

      <!-- BLOC 5 : STACK TECHNIQUE -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">‚öôÔ∏è Stack Technique <span class="badge">Technologies</span></div>
        </div>

        <div class="field-group">
          <div class="field-label">TECHNOLOGIES UTILIS√âES</div>
          <div class="field-value" onclick="copyText('out-techstack', this)">
            <span id="out-techstack">‚Äî</span>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>
      </div>

      <!-- BLOC 6 : D√âTAIL OPTIONS -->
      <div class="card" id="options-detail-card" style="display: none;">
        <div class="card-header">
          <div class="card-title">üîç D√©tail des Options <span class="badge">Scope</span></div>
        </div>

        <div class="field-group">
          <div class="field-label">OPTIONS S√âLECTIONN√âES ‚Äî CE QUI EST INCLUS / EXCLUS</div>
          <div class="field-value" onclick="copyText('out-options-detail', this)">
            <textarea id="out-options-detail" readonly style="min-height: 300px;"></textarea>
            <button class="copy-btn">COPIER</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    // DATA
    const projects = {
      website: {
        name: "Site Web",
        subtypes: [
          { 
            id: 'landing', 
            name: 'Landing Page / One-Page', 
            price: 1750, 
            desc: 'Site simple sur une seule page pour pr√©senter un produit ou un service.',
            includes: ['seo', 'form', 'analytics', 'cookies'],
            pages: 1,
            duration: '1-2 semaines',
            revisions: 2,
            warranty: 15,
            support: 'Email',
            phases: [
              { name: 'Cadrage & Brief', days: 1 },
              { name: 'Maquette & Design', days: 2 },
              { name: 'D√©veloppement', days: 4 },
              { name: 'Tests & Livraison', days: 1 }
            ],
            deliverables: [
              'Code source complet (GitHub)',
              'Site d√©ploy√© sur Vercel',
              'Guide de prise en main rapide'
            ],
            prerequisites: [
              'Logo HD (SVG ou PNG)',
              'Textes et accroches',
              'Photos/visuels du produit ou service'
            ],
            techStack: ['Next.js 15', 'Tailwind CSS', 'Framer Motion', 'Vercel']
          },
          { 
            id: 'portfolio', 
            name: 'Portfolio Cr√©atif', 
            price: 3000, 
            desc: 'Site personnel pour pr√©senter des travaux avec animations et galerie.',
            includes: ['seo', 'form', 'animations', 'analytics', 'cookies'],
            pages: '5-7',
            duration: '2-3 semaines',
            revisions: 2,
            warranty: 30,
            support: 'Email',
            phases: [
              { name: 'Cadrage & Direction artistique', days: 2 },
              { name: 'Maquettes (Desktop + Mobile)', days: 3 },
              { name: 'D√©veloppement & Animations', days: 6 },
              { name: 'Tests & Optimisation', days: 2 },
              { name: 'Livraison & Formation', days: 1 }
            ],
            deliverables: [
              'Code source complet (GitHub)',
              'Site d√©ploy√© sur Vercel',
              'Documentation technique',
              'Guide d\'ajout de projets'
            ],
            prerequisites: [
              'Logo ou identit√© visuelle',
              'Projets √† pr√©senter (images HD, descriptions)',
              'Bio et informations de contact',
              'Liens r√©seaux sociaux'
            ],
            techStack: ['Next.js 15', 'Tailwind CSS', 'Framer Motion', 'Vercel']
          },
          { 
            id: 'corporate', 
            name: 'Site Vitrine Standard', 
            price: 4250, 
            desc: 'Site complet pour entreprise : Accueil, Services, √Ä propos, Contact, Blog.',
            includes: ['seo', 'form', 'animations', 'analytics', 'cookies', 'legal', 'multilang'],
            pages: 5,
            duration: '3-4 semaines',
            revisions: 3,
            warranty: 30,
            support: 'Email + 1 appel',
            phases: [
              { name: 'Cadrage & Strat√©gie', days: 2 },
              { name: 'Arborescence & Wireframes', days: 2 },
              { name: 'Design UI/UX complet', days: 4 },
              { name: 'D√©veloppement', days: 8 },
              { name: 'Int√©gration contenus', days: 2 },
              { name: 'Tests & SEO', days: 2 },
              { name: 'Livraison & Formation', days: 1 }
            ],
            deliverables: [
              'Code source complet (GitHub)',
              'Site d√©ploy√© sur Vercel',
              'Documentation technique compl√®te',
              'Guide d\'administration',
              'Rapport SEO initial'
            ],
            prerequisites: [
              'Logo vectoriel (SVG)',
              'Charte graphique (si existante)',
              'Contenus texte r√©dig√©s par page',
              'Photos √©quipe / locaux / produits',
              'Acc√®s domaine existant (si applicable)'
            ],
            techStack: ['Next.js 15', 'Tailwind CSS', 'Framer Motion', 'MDX/Blog', 'Vercel']
          }
        ],
        technologies: "Technologies : React, Next.js, Tailwind CSS.",
        staticIncludes: [
          "Design personnalis√© (UI/UX) et responsive",
          "Structure s√©mantique et accessible"
        ]
      },
      application: {
        name: "Application Web",
        subtypes: [
          { 
            id: 'mvp', 
            name: 'MVP (Produit Minimum Viable)', 
            price: 6250, 
            desc: 'Version essentielle pour lancer et tester le march√© rapidement.',
            includes: ['seo', 'form', 'auth', 'analytics', 'cookies'],
            screens: '5-8',
            duration: '4-6 semaines',
            revisions: 3,
            warranty: 30,
            support: 'Email + 2h call',
            phases: [
              { name: 'Cadrage produit & User Stories', days: 3 },
              { name: 'Architecture technique', days: 2 },
              { name: 'Design UI/UX (√©crans cl√©s)', days: 4 },
              { name: 'D√©veloppement Backend', days: 8 },
              { name: 'D√©veloppement Frontend', days: 8 },
              { name: 'Tests & QA', days: 3 },
              { name: 'D√©ploiement & Formation', days: 2 }
            ],
            deliverables: [
              'Code source complet (GitHub)',
              'Application d√©ploy√©e (Vercel + Supabase)',
              'Documentation technique',
              'Documentation API',
              'Guide utilisateur',
              'Acc√®s base de donn√©es'
            ],
            prerequisites: [
              'Cahier des charges ou brief d√©taill√©',
              'User stories prioritaires',
              'Logo et √©l√©ments de marque',
              'Compte Supabase (ou on le cr√©e ensemble)',
              'Liste des int√©grations tierces souhait√©es'
            ],
            techStack: ['Next.js 15', 'Supabase', 'PostgreSQL', 'Tailwind CSS', 'Vercel']
          },
          { 
            id: 'saas', 
            name: 'SaaS Complet', 
            price: 12500, 
            desc: 'Application compl√®te avec abonnements, multi-utilisateurs et dashboard.',
            includes: ['seo', 'form', 'animations', 'auth', 'analytics', 'cookies', 'stripe', 'legal', 'emails-transac'],
            screens: '15-25',
            duration: '8-12 semaines',
            revisions: 4,
            warranty: 60,
            support: 'Email + 5h call',
            phases: [
              { name: 'Discovery & Product Strategy', days: 5 },
              { name: 'Architecture & Sch√©ma DB', days: 4 },
              { name: 'Design System & UI/UX', days: 8 },
              { name: 'D√©veloppement Core Backend', days: 15 },
              { name: 'D√©veloppement Frontend', days: 15 },
              { name: 'Int√©gration Stripe & Billing', days: 5 },
              { name: 'Tests complets & S√©curit√©', days: 5 },
              { name: 'Beta testing', days: 5 },
              { name: 'D√©ploiement & Onboarding', days: 3 }
            ],
            deliverables: [
              'Code source complet (GitHub priv√©)',
              'Application production-ready',
              'Documentation technique compl√®te',
              'Documentation API (Swagger/OpenAPI)',
              'Guide administrateur',
              'Guide utilisateur',
              'Proc√©dures de backup',
              'Runbook op√©rationnel'
            ],
            prerequisites: [
              'Vision produit claire',
              'Cahier des charges d√©taill√©',
              'Mod√®le de pricing d√©fini',
              'Compte Stripe',
              'Domaine et emails configur√©s',
              'Identit√© visuelle compl√®te'
            ],
            techStack: ['Next.js 15', 'Supabase', 'PostgreSQL', 'Stripe', 'Resend', 'Tailwind CSS', 'Vercel']
          },
          { 
            id: 'dashboard', 
            name: 'Dashboard M√©tier / Interne', 
            price: 8750, 
            desc: 'Outil de gestion interne pour entreprise, gestion de donn√©es.',
            includes: ['seo', 'form', 'auth', 'analytics', 'export'],
            screens: '10-15',
            duration: '6-8 semaines',
            revisions: 3,
            warranty: 30,
            support: 'Email + 3h call',
            phases: [
              { name: 'Analyse des besoins m√©tier', days: 3 },
              { name: 'Mod√©lisation donn√©es', days: 3 },
              { name: 'Design UI Dashboard', days: 5 },
              { name: 'D√©veloppement Backend & API', days: 12 },
              { name: 'D√©veloppement Frontend', days: 10 },
              { name: 'Tests & Validation m√©tier', days: 4 },
              { name: 'D√©ploiement & Formation √©quipe', days: 3 }
            ],
            deliverables: [
              'Code source complet (GitHub)',
              'Application d√©ploy√©e',
              'Documentation technique',
              'Documentation API',
              'Manuel utilisateur',
              'Formation √©quipe (2h)',
              'Exports de donn√©es configur√©s'
            ],
            prerequisites: [
              'Description des processus m√©tier',
              'Exemples de donn√©es actuelles (Excel, etc.)',
              'Liste des utilisateurs et r√¥les',
              'R√®gles de gestion',
              'Int√©grations existantes (CRM, ERP, etc.)'
            ],
            techStack: ['Next.js 15', 'Supabase', 'PostgreSQL', 'Tailwind CSS', 'Recharts', 'Vercel']
          }
        ],
        technologies: "Technologies : React, Next.js, Node.js/Supabase, PostgreSQL.",
        staticIncludes: [
          "Architecture Clean Architecture",
          "Tests fonctionnels et unitaires",
          "Base de donn√©es temps r√©el"
        ]
      },
      shopify: {
        name: "Shopify",
        subtypes: [
          { 
            id: 'headless', 
            name: 'Boutique Headless (Next.js)', 
            price: 7500, 
            desc: 'Performance maximale, design 100% sur mesure.',
            includes: ['seo', 'animations', 'stripe', 'analytics', 'cookies', 'legal', 'promo', 'pixel'],
            pages: '8-12',
            duration: '5-7 semaines',
            revisions: 3,
            warranty: 30,
            support: 'Email + 2h call',
            phases: [
              { name: 'Audit catalogue & besoins', days: 2 },
              { name: 'Design e-commerce complet', days: 6 },
              { name: 'Configuration Shopify Backend', days: 3 },
              { name: 'D√©veloppement Frontend Headless', days: 15 },
              { name: 'Int√©gration panier & checkout', days: 5 },
              { name: 'Tests & Optimisation perf', days: 4 },
              { name: 'Migration donn√©es & Go-live', days: 3 }
            ],
            deliverables: [
              'Code source frontend (GitHub)',
              'Boutique Shopify configur√©e',
              'Site headless d√©ploy√©',
              'Documentation technique',
              'Guide gestion catalogue',
              'Formation admin Shopify (1h)'
            ],
            prerequisites: [
              'Compte Shopify (Basic minimum)',
              'Catalogue produits (CSV ou existant)',
              'Photos produits HD',
              'Politique de livraison/retour',
              'Identit√© visuelle',
              'Compte Stripe (si paiement custom)'
            ],
            techStack: ['Next.js 15', 'Shopify Storefront API', 'GraphQL', 'Tailwind CSS', 'Vercel']
          }
        ],
        technologies: "Technologies : Next.js, Shopify Storefront API, Stripe.",
        staticIncludes: [
          "Gestion catalogue Shopify",
          "Performance e-commerce maximale"
        ]
      },
      custom: {
        name: "Consulting",
        subtypes: [
          { 
            id: 'audit', 
            name: 'Audit Technique', 
            price: 1200, 
            desc: 'Analyse approfondie du code, performance et s√©curit√©.',
            includes: [],
            duration: '3-5 jours',
            revisions: 1,
            warranty: 0,
            support: 'Email',
            phases: [
              { name: 'Acc√®s & Prise en main', days: 1 },
              { name: 'Analyse code & architecture', days: 2 },
              { name: 'Tests performance & s√©curit√©', days: 1 },
              { name: 'R√©daction rapport', days: 1 }
            ],
            deliverables: [
              'Rapport d\'audit complet (PDF)',
              'Liste des vuln√©rabilit√©s',
              'Recommandations prioris√©es',
              'Roadmap d\'am√©lioration',
              'Call de restitution (30min)'
            ],
            prerequisites: [
              'Acc√®s au repository (GitHub/GitLab)',
              'Acc√®s environnement de staging',
              'Documentation existante (si applicable)',
              'Contexte business et contraintes'
            ],
            techStack: ['Lighthouse', 'SonarQube', 'OWASP ZAP', 'Bundle Analyzer']
          },
          { 
            id: 'dev', 
            name: 'Journ√©e de D√©veloppement', 
            price: 300, 
            desc: 'Renfort technique ou fonctionnalit√© sp√©cifique.',
            includes: [],
            duration: '1 jour',
            revisions: 1,
            warranty: 7,
            support: 'Email',
            phases: [
              { name: 'Brief & Cadrage', days: 0.5 },
              { name: 'D√©veloppement', days: 0.5 }
            ],
            deliverables: [
              'Code livr√© (PR ou commit)',
              'Documentation des changements',
              'Tests unitaires (si applicable)'
            ],
            prerequisites: [
              'Brief clair de la t√¢che',
              'Acc√®s au repository',
              'Environnement de dev fonctionnel',
              'Crit√®res d\'acceptation d√©finis'
            ],
            techStack: ['Selon projet client']
          }
        ],
        technologies: "",
        staticIncludes: []
      }
    };

    const optionCategories = [
      { id: 'design', name: 'üé® Design', icon: 'üé®' },
      { id: 'tech', name: 'üîß Technique', icon: 'üîß' },
      { id: 'marketing', name: 'üìà Marketing', icon: 'üìà' },
      { id: 'legal', name: 'üìã L√©gal', icon: 'üìã' },
      { id: 'support', name: 'üõ† Support', icon: 'üõ†' }
    ];

    const allOptions = [
      { 
        id: 'analytics', 
        name: 'Analytics', 
        price: 75,
        category: 'marketing',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Installation GA4 ou Plausible',
            'Tracking pages vues automatique',
            '√âv√©nements clics CTA principaux',
            'Dashboard de suivi'
          ],
          excluded: [
            'Tracking e-commerce avanc√©',
            '√âv√©nements custom complexes',
            'Rapports personnalis√©s'
          ]
        },
        examples: ['Tableau de bord visiteurs', 'Sources de trafic', 'Pages les plus vues']
      },
      { 
        id: 'cookies', 
        name: 'Banni√®re cookies / RGPD', 
        price: 100,
        category: 'legal',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Banni√®re de consentement',
            'Stockage pr√©f√©rences utilisateur',
            'Blocage scripts avant consentement',
            'Bouton "G√©rer mes cookies"'
          ],
          excluded: [
            'Audit RGPD complet',
            'DPO externalis√©',
            'Registre des traitements'
          ]
        },
        examples: ['Banni√®re en bas de page', 'Modal de pr√©f√©rences', 'Lien footer "Cookies"']
      },
      { 
        id: 'legal', 
        name: 'Pages l√©gales', 
        price: 75,
        category: 'legal',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Page Mentions l√©gales',
            'Page Politique de confidentialit√©',
            'Template CGV/CGU (√† personnaliser)',
            'Liens footer'
          ],
          excluded: [
            'R√©daction juridique sur mesure',
            'Validation par avocat',
            'CGV e-commerce complexes'
          ]
        },
        examples: ['Mentions l√©gales standard', 'Politique vie priv√©e', 'Conditions g√©n√©rales']
      },
      { 
        id: 'cms', 
        name: 'Int√©gration CMS', 
        price: 300,
        category: 'tech',
        effort: '3-4 jours',
        complexity: 'complex',
        scope: {
          included: [
            'Installation Strapi ou Sanity',
            '3 types de contenu max',
            '10 champs par type max',
            'M√©dia library (images)',
            'Interface admin configur√©e'
          ],
          excluded: [
            'Types de contenu suppl√©mentaires (+50‚Ç¨/type)',
            'Workflows de validation',
            'Multi-utilisateurs avanc√©',
            'Internationalisation CMS'
          ]
        },
        examples: ['Blog articles', 'T√©moignages clients', 'FAQ dynamique', '√âquipe']
      },
      { 
        id: 'animations', 
        name: 'Animations avanc√©es', 
        price: 200,
        category: 'design',
        effort: '1-2 jours',
        complexity: 'medium',
        scope: {
          included: [
            '5 animations custom max',
            'Transitions entre pages',
            'Animations au scroll (fade, slide)',
            'Micro-interactions (hover, click)'
          ],
          excluded: [
            'Animations 3D / WebGL',
            'Animations SVG complexes',
            'Parallax multi-couches',
            'Animations interactives (curseur custom)'
          ]
        },
        examples: ['Fade-in au scroll', 'Cards qui s\'√©l√®vent au hover', 'Menu burger anim√©', 'Loader custom']
      },
      { 
        id: 'multilang', 
        name: 'Multilingue', 
        price: 150,
        category: 'tech',
        effort: '1 jour',
        complexity: 'medium',
        scope: {
          included: [
            '2 langues (FR/EN)',
            '50 cl√©s de traduction max',
            'Switch langue dans header',
            'URLs localis√©es (/fr, /en)',
            'D√©tection langue navigateur'
          ],
          excluded: [
            'Langues suppl√©mentaires (+50‚Ç¨/langue)',
            'Traduction des contenus (textes fournis)',
            'SEO multilingue avanc√© (hreflang)',
            'CMS multilingue'
          ]
        },
        examples: ['Toggle FR/EN', 'URLs /fr/about ‚Üí /en/about', 'Redirection auto selon pays']
      },
      { 
        id: 'darkmode', 
        name: 'Dark mode', 
        price: 150,
        category: 'design',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Th√®me clair et sombre',
            'Toggle dans le header',
            'D√©tection pr√©f√©rence syst√®me',
            'Persistance du choix (localStorage)',
            'Transition fluide entre th√®mes'
          ],
          excluded: [
            'Th√®mes custom suppl√©mentaires',
            'Mode auto jour/nuit',
            'Personnalisation couleurs par user'
          ]
        },
        examples: ['Ic√¥ne soleil/lune', 'Transition 0.3s sur changement', 'Respect prefers-color-scheme']
      },
      { 
        id: 'newsletter', 
        name: 'Newsletter', 
        price: 150,
        category: 'marketing',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            '1 formulaire d\'inscription',
            'Int√©gration Mailchimp ou Resend',
            'Double opt-in',
            'Message de confirmation',
            '1 liste de diffusion'
          ],
          excluded: [
            'Design templates emails',
            'S√©quences automatis√©es',
            'Segmentation audience',
            'A/B testing'
          ]
        },
        examples: ['Formulaire footer', 'Popup inscription', 'Page de confirmation']
      },
      { 
        id: 'form', 
        name: 'Formulaire contact avanc√©', 
        price: 100,
        category: 'tech',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Formulaire multi-champs',
            'Validation temps r√©el',
            'Protection anti-spam (honeypot)',
            'Notification email (√† toi)',
            'Email de confirmation (au client)'
          ],
          excluded: [
            'Upload fichiers volumineux',
            'Formulaires multi-√©tapes',
            'Logique conditionnelle complexe',
            'Int√©gration CRM'
          ]
        },
        examples: ['Nom, email, message, sujet', 'Erreurs inline', 'Toast de succ√®s']
      },
      { 
        id: 'seo', 
        name: 'SEO technique', 
        price: 150,
        category: 'marketing',
        effort: '1 jour',
        complexity: 'medium',
        scope: {
          included: [
            'Meta title/description par page',
            'Sitemap XML automatique',
            'Robots.txt configur√©',
            'Schema.org (Organization, WebSite)',
            'Open Graph (r√©seaux sociaux)',
            'Images optimis√©es (WebP, lazy loading)'
          ],
          excluded: [
            'R√©daction contenu SEO',
            'Strat√©gie mots-cl√©s',
            'Backlinks',
            'Suivi positionnement',
            'SEO local (Google Business)'
          ]
        },
        examples: ['Balises meta dynamiques', 'Rich snippets Google', 'Preview LinkedIn/Twitter']
      },
      { 
        id: 'stripe', 
        name: 'Paiement Stripe', 
        price: 250,
        category: 'tech',
        effort: '2 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Checkout Stripe int√©gr√©',
            'Paiement unique (carte)',
            'Webhooks (confirmation paiement)',
            'Emails de re√ßu automatiques',
            'Gestion erreurs paiement',
            'Mode test + production'
          ],
          excluded: [
            'Abonnements r√©currents ‚Üí addon',
            'Facturation automatique ‚Üí addon',
            'Multi-devises',
            'Apple Pay / Google Pay',
            'Paiement en plusieurs fois'
          ]
        },
        examples: ['Bouton "Payer"', 'Redirection Checkout', 'Page succ√®s/√©chec'],
        addons: [
          { id: 'stripe-sub', name: 'Abonnements r√©currents', price: 150, effort: '1-2 jours' },
          { id: 'stripe-invoice', name: 'Facturation automatique', price: 100, effort: '1 jour' }
        ],
        requires: [],
        recommendedWith: ['auth', 'legal']
      },
      { 
        id: 'auth', 
        name: 'Authentification', 
        price: 300,
        category: 'tech',
        effort: '2-3 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Inscription par email/password',
            'Connexion / D√©connexion',
            'Page "Mot de passe oubli√©"',
            'Sessions persistantes (7 jours)',
            'Protection routes priv√©es',
            'Page profil utilisateur basique'
          ],
          excluded: [
            'OAuth (Google, GitHub) ‚Üí addon',
            'Magic Link ‚Üí addon',
            'Gestion des r√¥les ‚Üí addon',
            '2FA ‚Üí addon',
            'SSO entreprise'
          ]
        },
        examples: ['Page /login', 'Page /register', 'Email reset password', 'Redirect si non connect√©'],
        addons: [
          { id: 'auth-social', name: 'OAuth (Google, GitHub)', price: 100, effort: '0.5 jour' },
          { id: 'auth-magic', name: 'Magic Link', price: 75, effort: '0.5 jour' },
          { id: 'auth-roles', name: 'Gestion des r√¥les', price: 150, effort: '1 jour' },
          { id: 'auth-2fa', name: 'Double authentification', price: 200, effort: '1-2 jours' }
        ],
        requires: [],
        recommendedWith: ['legal', 'cookies']
      },
      { 
        id: 'figma', 
        name: 'Maquettes Figma', 
        price: 150,
        category: 'design',
        effort: '2-3 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Maquettes desktop (5 pages max)',
            'Maquettes mobile (5 pages max)',
            'Composants r√©utilisables',
            'Guide de style (couleurs, typos)',
            'Fichier Figma livr√©'
          ],
          excluded: [
            'Maquettes tablette',
            'Prototypage interactif',
            'Design system complet',
            'Illustrations custom'
          ]
        },
        examples: ['Home, About, Contact, Services, Blog', 'Composants boutons/cards', 'Palette couleurs']
      },
      { 
        id: 'training', 
        name: 'Formation (1h)', 
        price: 75,
        category: 'support',
        effort: '1 heure',
        complexity: 'easy',
        scope: {
          included: [
            'Call vid√©o 1h (Zoom/Meet)',
            'Partage d\'√©cran',
            'Prise en main de l\'interface',
            'Enregistrement vid√©o fourni',
            'Support Q&A pendant le call'
          ],
          excluded: [
            'Formation √©quipe (plusieurs personnes)',
            'Documentation √©crite d√©taill√©e',
            'Sessions de suivi',
            'Formation technique (code)'
          ]
        },
        examples: ['Comment modifier un article', 'Ajouter un produit', 'Consulter les stats']
      },
      { 
        id: 'maintenance', 
        name: 'Maintenance 3 mois', 
        price: 600,
        category: 'support',
        effort: 'Continu',
        complexity: 'easy',
        scope: {
          included: [
            'Corrections bugs li√©s au dev',
            'Mises √† jour s√©curit√© d√©pendances',
            'Monitoring uptime basique',
            'Support email prioritaire',
            'Temps de r√©ponse < 48h'
          ],
          excluded: [
            'Nouvelles fonctionnalit√©s',
            'Modifications design',
            'Support t√©l√©phonique',
            'Maintenance contenu (textes, images)',
            'H√©bergement'
          ]
        },
        examples: ['Fix bug formulaire', 'Update Next.js 15.1', 'Alert si site down']
      },
      { 
        id: 'hosting', 
        name: 'H√©bergement 1 an', 
        price: 300,
        category: 'support',
        effort: 'Continu',
        complexity: 'easy',
        scope: {
          included: [
            'H√©bergement Vercel Pro',
            'D√©ploiement continu (Git push)',
            'SSL/HTTPS automatique',
            'CDN mondial',
            'Analytics Vercel inclus',
            'Logs et monitoring'
          ],
          excluded: [
            'Nom de domaine (√† fournir)',
            'Emails professionnels',
            'Base de donn√©es (Supabase s√©par√©)',
            'Support Vercel direct'
          ]
        },
        examples: ['Auto-deploy sur push', 'Preview branches', 'Rollback instantan√©'],
        requires: [],
        recommendedWith: ['maintenance']
      },
      { 
        id: 'search', 
        name: 'Recherche avanc√©e', 
        price: 250,
        category: 'tech',
        effort: '2 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Barre de recherche',
            'Recherche instantan√©e (fuzzy)',
            'Filtres par cat√©gorie',
            'Mise en surbrillance r√©sultats'
          ],
          excluded: [
            'Algolia/Meilisearch (si gros volume)',
            'Recherche vocale',
            'Suggestions auto-complete avanc√©es',
            'Recherche multi-langue'
          ]
        },
        examples: ['Recherche articles blog', 'Filtrer produits', 'Search-as-you-type']
      },
      { 
        id: 'calendar', 
        name: 'Calendrier / R√©servation', 
        price: 300,
        category: 'tech',
        effort: '3-4 jours',
        complexity: 'complex',
        scope: {
          included: [
            'Calendrier interactif',
            'S√©lection cr√©neaux disponibles',
            'Confirmation par email',
            'Sync Google Calendar',
            'Page de gestion RDV'
          ],
          excluded: [
            'Paiement √† la r√©servation ‚Üí n√©cessite Stripe',
            'Rappels SMS',
            'R√©currence automatique',
            'Multi-praticiens'
          ]
        },
        examples: ['Prise de RDV coaching', 'R√©servation consultation', 'Booking cr√©neaux'],
        recommendedWith: ['auth', 'emails-transac']
      },
      { 
        id: 'chat', 
        name: 'Chat en direct', 
        price: 150,
        category: 'tech',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Widget chat (Crisp ou Intercom)',
            'Configuration compte',
            'Personnalisation couleurs',
            'Messages automatiques'
          ],
          excluded: [
            'Chatbot IA',
            'Abonnement outil (√† ta charge)',
            'Formation √©quipe support',
            'Int√©gration CRM'
          ]
        },
        examples: ['Bulle chat en bas √† droite', 'Message de bienvenue', 'Horaires dispo']
      },
      { 
        id: 'emails-transac', 
        name: 'Emails transactionnels', 
        price: 200,
        category: 'tech',
        effort: '1-2 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Configuration Resend/Sendgrid',
            '5 templates emails max',
            'Emails de confirmation',
            'Emails de notification',
            'Design responsive emails'
          ],
          excluded: [
            'S√©quences automatis√©es (drip)',
            'Templates suppl√©mentaires (+30‚Ç¨/email)',
            'A/B testing emails',
            'Analytics avanc√©s emails'
          ]
        },
        examples: ['Confirmation inscription', 'Reset password', 'Notification commande'],
        recommendedWith: ['auth']
      },
      { 
        id: 'export', 
        name: 'Export donn√©es', 
        price: 200,
        category: 'tech',
        effort: '1 jour',
        complexity: 'medium',
        scope: {
          included: [
            'Export CSV',
            'Export PDF (rapports)',
            '3 types d\'exports max',
            'Bouton t√©l√©chargement'
          ],
          excluded: [
            'Exports planifi√©s automatiques',
            'Export vers Google Sheets',
            'Formats Excel complexes',
            'Rapports personnalis√©s'
          ]
        },
        examples: ['T√©l√©charger liste clients', 'Export factures PDF', 'Donn√©es analytics']
      },
      { 
        id: 'api-externe', 
        name: 'Int√©gration API externe', 
        price: 350,
        category: 'tech',
        effort: '2-4 jours',
        complexity: 'complex',
        scope: {
          included: [
            '1 int√©gration API',
            'Authentification API',
            'Gestion erreurs',
            'Cache des requ√™tes',
            'Documentation technique'
          ],
          excluded: [
            'APIs suppl√©mentaires (+200‚Ç¨/API)',
            'Webhooks bidirectionnels',
            'Sync temps r√©el',
            'Maintenance API tierce'
          ]
        },
        examples: ['API m√©t√©o', 'Connexion Airtable', 'Import donn√©es externe']
      },
      { 
        id: 'promo', 
        name: 'Codes promo / R√©ductions', 
        price: 200,
        category: 'tech',
        effort: '1-2 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Syst√®me de codes promo',
            'R√©ductions % ou montant fixe',
            'Dates de validit√©',
            'Usage unique ou multiple',
            'Interface admin gestion codes'
          ],
          excluded: [
            'Codes auto-g√©n√©r√©s',
            'R√©ductions conditionnelles complexes',
            'Parrainage',
            'Cartes cadeaux'
          ]
        },
        examples: ['Code LAUNCH20', 'Promo -10%', 'Offre premier achat']
      },
      { 
        id: 'wishlist', 
        name: 'Wishlist / Favoris', 
        price: 150,
        category: 'tech',
        effort: '1 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Bouton ajouter aux favoris',
            'Page wishlist utilisateur',
            'Persistance (localStorage ou compte)',
            'Compteur favoris'
          ],
          excluded: [
            'Partage wishlist',
            'Alertes prix',
            'Wishlist collaborative'
          ]
        },
        examples: ['C≈ìur sur fiche produit', 'Ma liste d\'envies', 'Sauvegarder pour plus tard'],
        requires: ['auth']
      },
      { 
        id: 'reviews', 
        name: 'Avis clients', 
        price: 200,
        category: 'tech',
        effort: '2 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Syst√®me de notation (√©toiles)',
            'Formulaire avis',
            'Affichage avis sur fiche',
            'Mod√©ration admin',
            'Note moyenne calcul√©e'
          ],
          excluded: [
            'Avis v√©rifi√©s (achat)',
            'Photos dans avis',
            'R√©ponses aux avis',
            'Import avis existants'
          ]
        },
        examples: ['5 √©toiles', 'Commentaire client', 'Note globale produit'],
        requires: ['auth']
      },
      { 
        id: 'hotjar', 
        name: 'Hotjar / Heatmaps', 
        price: 100,
        category: 'marketing',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Installation Hotjar ou alternative',
            'Configuration heatmaps',
            'Enregistrement sessions',
            'Sondages basiques'
          ],
          excluded: [
            'Analyse des donn√©es',
            'Abonnement Hotjar (√† ta charge)',
            'Rapports UX',
            'Recommandations'
          ]
        },
        examples: ['Carte de chaleur clics', 'Replay sessions', 'O√π les gens scrollent']
      },
      { 
        id: 'pixel', 
        name: 'Pixels tracking (FB/TikTok)', 
        price: 75,
        category: 'marketing',
        effort: '0.5 jour',
        complexity: 'easy',
        scope: {
          included: [
            'Installation Pixel Facebook',
            'Installation Pixel TikTok',
            'Events standards (PageView, Purchase)',
            'V√©rification via extension'
          ],
          excluded: [
            'Events custom avanc√©s',
            'API Conversions (server-side)',
            'Configuration audiences',
            'Cr√©ation campagnes pub'
          ]
        },
        examples: ['Retargeting visiteurs', 'Tracking achats', 'Audiences similaires'],
        recommendedWith: ['analytics', 'cookies']
      },
      { 
        id: 'crm', 
        name: 'Int√©gration CRM', 
        price: 200,
        category: 'marketing',
        effort: '1-2 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Connexion HubSpot, Notion ou Airtable',
            'Envoi leads formulaire',
            'Mapping champs basique',
            'Test et validation'
          ],
          excluded: [
            'Sync bidirectionnelle',
            'Workflows automatis√©s',
            'Multi-CRM',
            'Formation CRM'
          ]
        },
        examples: ['Lead ‚Üí HubSpot', 'Contact ‚Üí Notion DB', 'Prospect ‚Üí Airtable'],
        requires: ['form']
      },
      { 
        id: 'accessibility', 
        name: 'Audit accessibilit√© WCAG', 
        price: 200,
        category: 'design',
        effort: '2 jours',
        complexity: 'medium',
        scope: {
          included: [
            'Audit WCAG 2.1 AA',
            'Rapport des probl√®mes',
            'Corrections prioritaires',
            'Navigation clavier',
            'Contraste couleurs',
            'Alt texts images'
          ],
          excluded: [
            'Certification officielle',
            'WCAG AAA',
            'Tests utilisateurs handicap√©s',
            'Audit PDF accessibles'
          ]
        },
        examples: ['Tab navigation', 'Screen reader friendly', 'Focus visible']
      },
      { 
        id: 'lottie', 
        name: 'Animations Lottie/GSAP', 
        price: 200,
        category: 'design',
        effort: '2-3 jours',
        complexity: 'complex',
        scope: {
          included: [
            '3 animations Lottie int√©gr√©es',
            'Animations scroll GSAP',
            'Optimisation performance',
            'Fallback si pas support√©'
          ],
          excluded: [
            'Cr√©ation animations (fichiers fournis)',
            'Animations 3D',
            'Animations interactives complexes',
            'WebGL'
          ]
        },
        examples: ['Loader anim√©', 'Ic√¥nes qui bougent', 'Parallax scroll'],
        recommendedWith: ['animations']
      }
    ];

    // STATE
    let currentProject = 'website';
    let selectedOptions = new Set();

    // INIT
    function init() {
      renderOptions();
      selectProject('website');
    }

    function selectProject(pid) {
      currentProject = pid;
      
      // Update UI classes
      document.querySelectorAll('.project-card').forEach(el => el.classList.remove('active'));
      document.querySelector(`.project-card[onclick="selectProject('${pid}')"]`).classList.add('active');

      // Fill Subtype Select
      const select = document.getElementById('subTypeSelect');
      select.innerHTML = projects[pid].subtypes.map(sub => 
        `<option value="${sub.id}">${sub.name}</option>`
      ).join('');
      
      // Reset Select to first option
      select.selectedIndex = 0;

      // RESET OPTIONS: Uncheck all options that are not included by default in the FIRST subtype
      // This ensures a fresh start for the new project type
      const firstSubType = projects[pid].subtypes[0];
      const includedInNewProject = new Set(firstSubType.includes || []);
      
      allOptions.forEach(opt => {
        const chk = document.getElementById(`chk-${opt.id}`);
        if (chk) {
          // Si l'option n'est pas incluse par d√©faut, on la d√©coche
          // Si elle est incluse, elle sera g√©r√©e (coch√©e/disabled) par updateUI() juste apr√®s
          if (!includedInNewProject.has(opt.id)) {
            chk.checked = false;
          }
        }
      });

      updateUI();
    }

    function changeSubtype() {
      // 1. Identifier les inclusions du nouveau sous-type
      const subSelect = document.getElementById('subTypeSelect');
      const subTypeId = subSelect.value;
      const projData = projects[currentProject];
      const subType = projData.subtypes.find(s => s.id === subTypeId) || projData.subtypes[0];
      const includedInNewSubtype = new Set(subType.includes || []);

      // 2. Reset options (sauf celles incluses)
      allOptions.forEach(opt => {
        const chk = document.getElementById(`chk-${opt.id}`);
        if (chk) {
          // Si l'option n'est pas incluse dans le nouveau sous-type, on la d√©coche
          // (Si elle est incluse, elle sera coch√©e/disabled par updateUI ensuite)
          if (!includedInNewSubtype.has(opt.id)) {
            chk.checked = false;
          }
        }
      });

      // 3. Mettre √† jour l'interface
      updateUI();
    }

    function renderOptions() {
      const container = document.getElementById('optionsList');
      
      const getComplexityDots = (complexity) => {
        const levels = { easy: 1, medium: 2, complex: 3 };
        const level = levels[complexity] || 1;
        return [1, 2, 3].map(i => 
          `<span class="complexity-dot ${i <= level ? 'active ' + complexity : ''}"></span>`
        ).join('');
      };

      let html = '';
      
      optionCategories.forEach(cat => {
        const categoryOptions = allOptions.filter(opt => opt.category === cat.id);
        if (categoryOptions.length === 0) return;
        
        html += `<div class="option-category">`;
        html += `<div class="category-header">${cat.name}</div>`;
        
        categoryOptions.forEach(opt => {
          html += `
            <div class="option-item" id="opt-${opt.id}" onclick="toggleOption('${opt.id}')">
              <input type="checkbox" id="chk-${opt.id}">
              <span class="option-name">${opt.name}</span>
              <div class="option-meta">
                <span class="option-price">+${opt.price}‚Ç¨</span>
                <span class="option-effort">‚è± ${opt.effort}</span>
                <div class="complexity-dots">${getComplexityDots(opt.complexity)}</div>
              </div>
            </div>
          `;
        });
        
        html += `</div>`;
      });
      
      container.innerHTML = html;
    }

    function toggleOption(oid) {
      const el = document.getElementById(`opt-${oid}`);
      // Prevent toggling if included
      if (el.classList.contains('included')) return;

      const chk = document.getElementById(`chk-${oid}`);
      chk.checked = !chk.checked;
      updateUI();
    }

    function updateUI() {
      const projData = projects[currentProject];
      
      // R√©cup√©rer le sous-type s√©lectionn√©
      const subSelect = document.getElementById('subTypeSelect');
      const subTypeId = subSelect.value;
      const subType = projData.subtypes.find(s => s.id === subTypeId) || projData.subtypes[0];

      // 1. G√©rer les inclusions (Depuis le sous-type)
      const included = new Set(subType.includes || []);
      
      // Get currently checked options
      const checkedOptions = new Set();
      allOptions.forEach(opt => {
        const chk = document.getElementById(`chk-${opt.id}`);
        if (chk && chk.checked) checkedOptions.add(opt.id);
      });
      
      // Check dependencies
      const missingDeps = [];
      allOptions.forEach(opt => {
        const el = document.getElementById(`opt-${opt.id}`);
        const chk = document.getElementById(`chk-${opt.id}`);
        
        if (included.has(opt.id)) {
          el.classList.add('included');
          el.classList.remove('warning');
          chk.checked = true;
          chk.disabled = true;
        } else {
          el.classList.remove('included');
          chk.disabled = false;
          
          // Check if this option has missing dependencies
          if (chk.checked && opt.requires && opt.requires.length > 0) {
            const missing = opt.requires.filter(reqId => !checkedOptions.has(reqId) && !included.has(reqId));
            if (missing.length > 0) {
              el.classList.add('warning');
              const missingNames = missing.map(id => {
                const found = allOptions.find(o => o.id === id);
                return found ? found.name : id;
              });
              missingDeps.push({ option: opt.name, missing: missingNames });
            } else {
              el.classList.remove('warning');
            }
          } else {
            el.classList.remove('warning');
          }
        }
      });
      
      // Show dependency warnings
      let warningContainer = document.getElementById('dependency-warnings');
      if (!warningContainer) {
        warningContainer = document.createElement('div');
        warningContainer.id = 'dependency-warnings';
        const optionsList = document.getElementById('optionsList');
        optionsList.parentNode.insertBefore(warningContainer, optionsList);
      }
      
      if (missingDeps.length > 0) {
        warningContainer.innerHTML = missingDeps.map(dep => 
          `<div class="dependency-warning">‚ö†Ô∏è <strong>${dep.option}</strong> n√©cessite : ${dep.missing.join(', ')}</div>`
        ).join('');
      } else {
        warningContainer.innerHTML = '';
      }

      // 2. Calculer le prix et textes
      let total = subType.price;
      
      // DESCRIPTION COMPACTE POUR FREEBE
      let desc = subType.desc;
      desc += `\n${projData.technologies || ''}`;
      desc += `\nDur√©e estim√©e : ${subType.duration || '√Ä d√©finir'}`;
      
      // Collecter toutes les features actives
      let allFeatures = [];
      
      // 1. Static includes du projet
      if (projData.staticIncludes) {
        allFeatures = allFeatures.concat(projData.staticIncludes);
      }
      
      // 2. Options incluses par d√©faut dans le sous-type
      allOptions.forEach(opt => {
        if (included.has(opt.id)) {
          allFeatures.push(opt.name);
        }
      });

      // 3. Options payantes ajout√©es
      let paidOptions = [];
      allOptions.forEach(opt => {
        const chk = document.getElementById(`chk-${opt.id}`);
        if (chk.checked && !included.has(opt.id)) {
          total += opt.price;
          paidOptions.push({ name: opt.name, price: opt.price });
          allFeatures.push(opt.name);
        }
      });
      
      // Afficher toutes les features
      if (allFeatures.length > 0) {
        desc += `\n\nCe projet comprend : ${allFeatures.join(' ‚Ä¢ ')}.`;
      }
      
      // D√©tail des options payantes si pr√©sentes
      if (paidOptions.length > 0) {
        const paidList = paidOptions.map(o => `${o.name} (+${o.price}‚Ç¨)`).join(', ');
        desc += `\n\nOptions suppl√©mentaires : ${paidList}.`;
      }

      // 3. Render Output
      document.getElementById('displayPrice').textContent = total.toLocaleString('fr-FR') + ' ‚Ç¨';
      
      document.getElementById('out-designation').textContent = subType.name + (subType.pages ? ` (${subType.pages} pages)` : subType.screens ? ` (${subType.screens} √©crans)` : '');
      document.getElementById('out-price').textContent = total;
      document.getElementById('out-desc').value = desc;

      // 4. Render Phases
      if (subType.phases && subType.phases.length > 0) {
        const totalDays = subType.phases.reduce((sum, p) => sum + p.days, 0);
        let phasesText = subType.phases.map(p => {
          const daysLabel = p.days === 0.5 ? '¬Ω jour' : p.days === 1 ? '1 jour' : `${p.days} jours`;
          return `‚Ä¢ ${p.name.padEnd(35, '.')} ${daysLabel}`;
        }).join('\n');
        phasesText += '\n' + '‚îÄ'.repeat(45);
        phasesText += `\n  DUR√âE TOTALE ESTIM√âE : ${subType.duration}`;
        document.getElementById('out-phases').value = phasesText;
        document.getElementById('displayDuration').textContent = subType.duration;
      } else {
        document.getElementById('out-phases').value = 'Phases non d√©finies pour ce type de projet.';
        document.getElementById('displayDuration').textContent = subType.duration || '‚Äî';
      }

      // 5. Render Deliverables
      if (subType.deliverables && subType.deliverables.length > 0) {
        document.getElementById('out-deliverables').value = subType.deliverables.map(d => `‚úì ${d}`).join('\n');
      } else {
        document.getElementById('out-deliverables').value = 'Livrables √† d√©finir selon le projet.';
      }

      // 6. Render Prerequisites
      if (subType.prerequisites && subType.prerequisites.length > 0) {
        document.getElementById('out-prerequisites').value = subType.prerequisites.map(p => `‚ñ° ${p}`).join('\n');
      } else {
        document.getElementById('out-prerequisites').value = 'Pr√©requis √† d√©finir lors du cadrage.';
      }

      // 7. Render Tech Stack
      if (subType.techStack && subType.techStack.length > 0) {
        document.getElementById('out-techstack').textContent = subType.techStack.join(' ‚Ä¢ ');
      } else {
        document.getElementById('out-techstack').textContent = 'Technologies √† d√©finir selon le projet.';
      }

      // 8. Render Options Detail
      renderOptionsDetail(included);

      // 9. Generate Notes (CGV)
      generateNotes(total, subType);
    }

    function renderOptionsDetail(includedSet) {
      const selectedOptions = allOptions.filter(opt => {
        const chk = document.getElementById(`chk-${opt.id}`);
        return chk && chk.checked;
      });

      const optionsCard = document.getElementById('options-detail-card');
      
      if (selectedOptions.length === 0) {
        optionsCard.style.display = 'none';
        return;
      }
      
      optionsCard.style.display = 'block';
      
      let detailText = '';
      
      selectedOptions.forEach((opt, index) => {
        const isIncluded = includedSet.has(opt.id);
        const statusLabel = isIncluded ? '(INCLUS)' : `(+${opt.price}‚Ç¨)`;
        
        detailText += `${'‚ïê'.repeat(50)}\n`;
        detailText += `${opt.name.toUpperCase()} ${statusLabel}\n`;
        detailText += `${'‚îÄ'.repeat(50)}\n`;
        detailText += `‚è± Effort : ${opt.effort || 'N/A'}  |  Complexit√© : ${opt.complexity || 'N/A'}\n\n`;
        
        if (opt.scope && opt.scope.included && opt.scope.included.length > 0) {
          detailText += `‚úÖ INCLUS :\n`;
          opt.scope.included.forEach(item => {
            detailText += `   ‚Ä¢ ${item}\n`;
          });
          detailText += '\n';
        }
        
        if (opt.scope && opt.scope.excluded && opt.scope.excluded.length > 0) {
          detailText += `‚ùå NON INCLUS :\n`;
          opt.scope.excluded.forEach(item => {
            detailText += `   ‚Ä¢ ${item}\n`;
          });
          detailText += '\n';
        }
        
        if (opt.examples && opt.examples.length > 0) {
          detailText += `üí° EXEMPLES : ${opt.examples.join(', ')}\n`;
        }
        
        if (opt.addons && opt.addons.length > 0) {
          detailText += `\nüîå ADDONS DISPONIBLES :\n`;
          opt.addons.forEach(addon => {
            detailText += `   ‚Ä¢ ${addon.name} (+${addon.price}‚Ç¨, ${addon.effort || 'N/A'})\n`;
          });
        }
        
        if (opt.recommendedWith && opt.recommendedWith.length > 0) {
          const recNames = opt.recommendedWith.map(id => {
            const found = allOptions.find(o => o.id === id);
            return found ? found.name : id;
          });
          detailText += `\nüí¨ RECOMMAND√â AVEC : ${recNames.join(', ')}\n`;
        }
        
        detailText += '\n';
      });
      
      document.getElementById('out-options-detail').value = detailText.trim();
    }

    function generateNotes(totalPrice, subType) {
      const acomptePct = parseInt(document.getElementById('acompteSelect').value);
      const acompteMontant = Math.round(totalPrice * acomptePct / 100);
      const revisions = subType.revisions || 2;
      
      const chkHosting = document.getElementById('chk-hosting');
      const chkMulti = document.getElementById('chk-multilang');
      const nonInclus = [];
      if (!chkHosting.checked) nonInclus.push("h√©bergement");
      nonInclus.push("nom de domaine");
      if (!chkMulti.checked) nonInclus.push("traductions");
      nonInclus.push("r√©daction contenus");

      let notes = '';
      
      if (acomptePct === 100) {
        notes = `Paiement int√©gral √† la commande.`;
      } else {
        notes = `Acompte de ${acompteMontant}‚Ç¨ (${acomptePct}%) √† la commande.`;
      }
      
      notes += ` ${revisions} r√©visions incluses.`;
      
      if (subType.warranty && subType.warranty > 0) {
        notes += ` Garantie ${subType.warranty} jours.`;
      }
      
      notes += ` Non inclus : ${nonInclus.join(', ')}.`;
      notes += ` Voir annexe technique pour conditions d√©taill√©es.`;

      document.getElementById('out-notes').value = notes;
    }

    function copyText(id, container) {
      const el = document.getElementById(id);
      const text = el.value || el.textContent;
      const btn = container.querySelector('.copy-btn');
      
      navigator.clipboard.writeText(text).then(() => {
        btn.textContent = "‚úÖ Copi√©";
        btn.classList.add('copied');
        setTimeout(() => {
          btn.textContent = "COPIER";
          btn.classList.remove('copied');
        }, 1500);
      });
    }

    function generateAnnexePDF() {
      const projData = projects[currentProject];
      const subSelect = document.getElementById('subTypeSelect');
      const subTypeId = subSelect.value;
      const subType = projData.subtypes.find(s => s.id === subTypeId) || projData.subtypes[0];
      const included = new Set(subType.includes || []);
      
      // Collecter les options s√©lectionn√©es
      const selectedOpts = allOptions.filter(opt => {
        const chk = document.getElementById(`chk-${opt.id}`);
        return chk && chk.checked;
      });
      
      // Calculer le prix total
      let total = subType.price;
      selectedOpts.forEach(opt => {
        if (!included.has(opt.id)) total += opt.price;
      });

      // Construire le contenu HTML du PDF
      let html = `
        <html>
        <head>
          <meta charset="UTF-8">
          <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; padding: 40px; color: #1a1a1a; font-size: 11px; line-height: 1.5; }
            h1 { font-size: 20px; margin-bottom: 5px; color: #111; }
            h2 { font-size: 14px; margin: 25px 0 10px; padding-bottom: 5px; border-bottom: 2px solid #3b82f6; color: #3b82f6; }
            h3 { font-size: 12px; margin: 15px 0 8px; color: #333; }
            .header { margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #ddd; }
            .subtitle { color: #666; font-size: 12px; }
            .meta { display: flex; justify-content: space-between; margin-top: 15px; }
            .meta-item { text-align: center; }
            .meta-value { font-size: 16px; font-weight: 700; color: #3b82f6; }
            .meta-label { font-size: 9px; color: #888; text-transform: uppercase; }
            ul { margin: 8px 0 8px 20px; }
            li { margin: 4px 0; }
            .included { color: #22c55e; }
            .excluded { color: #ef4444; }
            .option-block { background: #f8f9fa; padding: 12px; margin: 10px 0; border-radius: 6px; border-left: 3px solid #3b82f6; }
            .option-title { font-weight: 700; font-size: 12px; margin-bottom: 5px; }
            .option-meta { font-size: 10px; color: #666; margin-bottom: 8px; }
            .two-col { display: flex; gap: 20px; }
            .two-col > div { flex: 1; }
            .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; font-size: 9px; color: #888; text-align: center; }
            .phase-row { display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px dotted #ddd; }
            .phase-name { flex: 1; }
            .phase-days { color: #3b82f6; font-weight: 600; }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>ANNEXE TECHNIQUE</h1>
            <div class="subtitle">${subType.name}${subType.pages ? ` (${subType.pages} pages)` : subType.screens ? ` (${subType.screens} √©crans)` : ''}</div>
            <div class="meta">
              <div class="meta-item"><div class="meta-value">${total.toLocaleString('fr-FR')}‚Ç¨</div><div class="meta-label">Prix HT</div></div>
              <div class="meta-item"><div class="meta-value">${subType.duration || 'N/A'}</div><div class="meta-label">Dur√©e</div></div>
              <div class="meta-item"><div class="meta-value">${subType.revisions || 2}</div><div class="meta-label">R√©visions</div></div>
              <div class="meta-item"><div class="meta-value">${subType.warranty || 0}j</div><div class="meta-label">Garantie</div></div>
            </div>
          </div>

          <h2>üìÖ Phases du Projet</h2>
          ${subType.phases ? subType.phases.map(p => `
            <div class="phase-row">
              <span class="phase-name">${p.name}</span>
              <span class="phase-days">${p.days === 0.5 ? '¬Ω jour' : p.days === 1 ? '1 jour' : p.days + ' jours'}</span>
            </div>
          `).join('') : '<p>Phases √† d√©finir.</p>'}

          <h2>üì¶ Livrables</h2>
          <ul>
            ${subType.deliverables ? subType.deliverables.map(d => `<li>‚úì ${d}</li>`).join('') : '<li>√Ä d√©finir</li>'}
          </ul>

          <h2>üìã Pr√©requis Client</h2>
          <ul>
            ${subType.prerequisites ? subType.prerequisites.map(p => `<li>‚òê ${p}</li>`).join('') : '<li>√Ä d√©finir</li>'}
          </ul>

          <h2>‚öôÔ∏è Stack Technique</h2>
          <p>${subType.techStack ? subType.techStack.join(' ‚Ä¢ ') : '√Ä d√©finir'}</p>

          <h2>üîç D√©tail des Options</h2>
          ${selectedOpts.map(opt => {
            const isIncluded = included.has(opt.id);
            return `
              <div class="option-block">
                <div class="option-title">${opt.name} ${isIncluded ? '(INCLUS)' : `(+${opt.price}‚Ç¨)`}</div>
                <div class="option-meta">‚è± ${opt.effort || 'N/A'} ‚Ä¢ Complexit√©: ${opt.complexity || 'N/A'}</div>
                ${opt.scope ? `
                  <div class="two-col">
                    <div>
                      <strong class="included">‚úì Inclus:</strong>
                      <ul>${opt.scope.included ? opt.scope.included.map(i => `<li>${i}</li>`).join('') : ''}</ul>
                    </div>
                    <div>
                      <strong class="excluded">‚úó Non inclus:</strong>
                      <ul>${opt.scope.excluded ? opt.scope.excluded.map(e => `<li>${e}</li>`).join('') : ''}</ul>
                    </div>
                  </div>
                ` : ''}
                ${opt.examples ? `<div style="margin-top:8px;"><strong>Exemples:</strong> ${opt.examples.join(', ')}</div>` : ''}
              </div>
            `;
          }).join('')}

          <h2>üìù Conditions</h2>
          <ul>
            <li><strong>D√©lais:</strong> D√©marrage sous 5 jours ouvr√©s apr√®s acompte. Retard client = report √©quivalent.</li>
            <li><strong>R√©visions:</strong> ${subType.revisions || 2} allers-retours inclus. Au-del√†: 60‚Ç¨/h.</li>
            <li><strong>Garantie:</strong> Correction bugs pendant ${subType.warranty || 30} jours apr√®s livraison.</li>
            <li><strong>Support:</strong> ${subType.support || 'Email'} inclus pendant la garantie.</li>
            <li><strong>Propri√©t√©:</strong> Transfert des droits √† r√©ception du solde.</li>
            <li><strong>Non inclus:</strong> Nom de domaine, r√©daction contenus, traductions (sauf mention).</li>
          </ul>

          <div class="footer">
            Document g√©n√©r√© le ${new Date().toLocaleDateString('fr-FR')} ‚Ä¢ Enzo Gazzoli ‚Ä¢ enzo.gazzoli@icloud.com
          </div>
        </body>
        </html>
      `;

      // Ouvrir dans une nouvelle fen√™tre pour impression/PDF
      const printWindow = window.open('', '_blank');
      printWindow.document.write(html);
      printWindow.document.close();
      
      // Attendre le chargement puis lancer l'impression
      printWindow.onload = function() {
        printWindow.print();
      };
    }

    // Start
    init();

  </script>
</body>
</html>